SELECT ALLS.* FROM
(
SELECT ALLS_WITH_ORDER.* FROM
(
SELECT KTG.* FROM
(
SELECT CONCAT('L',CRC32(UPPER(TRIM(С.ФИО)))) as PERSON_LEGISLATIVE_ID
,DATE_FORMAT(MIN(П.`Дата`),'%Y-%m-%d') as EFFECTIVE_START_DATE
,'4712-12-31' as EFFECTIVE_END_DATE
,'188772AEC11AAD11E053A647660A0CF2' as BUSINESS_GROUP_ID
,CONCAT('P',CRC32(UPPER(TRIM(С.ФИО)))) as PERSON_ID
,'KZ' as LEGISLATION_CODE
,'' as HIGHEST_EDUCATION_LEVEL
,'' as MARITAL_STATUS
,'' as MARITAL_STATUS_DATE
,CASE WHEN С.Пол=2 THEN 'F' ELSE 'M' END as SEX
,'' as ATTRIBUTE_CATEGORY
,'' as ATTRIBUTE1
,'' as ATTRIBUTE2
,'' as ATTRIBUTE3
,'' as ATTRIBUTE4
,'' as ATTRIBUTE5
,'' as ATTRIBUTE6
,'' as ATTRIBUTE7
,'' as ATTRIBUTE8
,'' as ATTRIBUTE9
,'' as ATTRIBUTE10
,'' as ATTRIBUTE11
,'' as ATTRIBUTE12
,'' as ATTRIBUTE13
,'' as ATTRIBUTE14
,'' as ATTRIBUTE15
,'' as ATTRIBUTE16
,'' as ATTRIBUTE17
,'' as ATTRIBUTE18
,'' as ATTRIBUTE19
,'' as ATTRIBUTE20
,'' as ATTRIBUTE21
,'' as ATTRIBUTE22
,'' as ATTRIBUTE23
,'' as ATTRIBUTE24
,'' as ATTRIBUTE25
,'' as ATTRIBUTE26
,'' as ATTRIBUTE27
,'' as ATTRIBUTE28
,'' as ATTRIBUTE29
,'' as ATTRIBUTE30
,'' as PER_INFROMATION_CATEGORY
,'' as PER_INFORMATION1
,'' as PER_INFORMATION2
,'' as PER_INFORMATION3
,'' as PER_INFORMATION4
,'' as PER_INFORMATION5
,'' as PER_INFORMATION6
,'' as PER_INFORMATION7
,'' as PER_INFORMATION8
,'' as PER_INFORMATION9
,'' as PER_INFORMATION10
,'' as PER_INFORMATION11
,'' as PER_INFORMATION12
,'' as PER_INFORMATION13
,'' as PER_INFORMATION14
,'' as PER_INFORMATION15
,'' as PER_INFORMATION16
,'' as PER_INFORMATION17
,'' as PER_INFORMATION18
,'' as PER_INFORMATION19
,'' as PER_INFORMATION20
,'' as PER_INFORMATION21
,'' as PER_INFORMATION22
,'' as PER_INFORMATION23
,'' as PER_INFORMATION24
,'' as PER_INFORMATION25
,'' as PER_INFORMATION26
,'' as PER_INFORMATION27
,'' as PER_INFORMATION28
,'' as PER_INFORMATION29
,'' as PER_INFORMATION30
,'' as PER_INFORMATION_DATE1
,'' as PER_INFORMATION_DATE2
,'' as PER_INFORMATION_DATE3
,'' as PER_INFORMATION_DATE4
,'' as PER_INFORMATION_DATE5
,'' as PER_INFORMATION_DATE6
,'' as PER_INFORMATION_DATE7
,'' as PER_INFORMATION_DATE8
,'' as PER_INFORMATION_DATE9
,'' as PER_INFORMATION_DATE10
,'' as PER_INFORMATION_DATE11
,'' as PER_INFORMATION_DATE12
,'' as PER_INFORMATION_DATE13
,'' as PER_INFORMATION_DATE14
,'' as PER_INFORMATION_DATE15
,'' as PER_INFORMATION_NUMBER1
,'' as PER_INFORMATION_NUMBER2
,'' as PER_INFORMATION_NUMBER3
,'' as PER_INFORMATION_NUMBER4
,'' as PER_INFORMATION_NUMBER5
,'' as PER_INFORMATION_NUMBER6
,'' as PER_INFORMATION_NUMBER7
,'' as PER_INFORMATION_NUMBER8
,'' as PER_INFORMATION_NUMBER9
,'' as PER_INFORMATION_NUMBER10
,'' as PER_INFORMATION_NUMBER11
,'' as PER_INFORMATION_NUMBER12
,'' as PER_INFORMATION_NUMBER13
,'' as PER_INFORMATION_NUMBER14
,'' as PER_INFORMATION_NUMBER15
,'' as PER_INFORMATION_NUMBER16
,'' as PER_INFORMATION_NUMBER17
,'' as PER_INFORMATION_NUMBER18
,'' as PER_INFORMATION_NUMBER19
,'' as PER_INFORMATION_NUMBER20
,'PERS_DATA_EFFDT' as FT_ALTERNATE_REC
,CONCAT('L',CRC32(UPPER(TRIM(С.ФИО)))) as FT_ALTERNATE_KEY
FROM kontrotenko_ktg.`Приказы` П
JOIN kontrotenko_ktg.`Сотрудники` С
ON П.`КодСотрудника`=С.`КодСотрудника`
GROUP BY UPPER(TRIM(С.`ФИО`))

) KTG
UNION ALL
SELECT KTGA.* FROM
(
SELECT CONCAT('L',CRC32(UPPER(TRIM(С.ФИО)))) as PERSON_LEGISLATIVE_ID
,DATE_FORMAT(MIN(П.`Дата`),'%Y-%m-%d') as EFFECTIVE_START_DATE
,'4712-12-31' as EFFECTIVE_END_DATE
,'188772AEC11AAD11E053A647660A0CF2' as BUSINESS_GROUP_ID
,CONCAT('P',CRC32(UPPER(TRIM(С.ФИО)))) as PERSON_ID
,'KZ' as LEGISLATION_CODE
,'' as HIGHEST_EDUCATION_LEVEL
,'' as MARITAL_STATUS
,'' as MARITAL_STATUS_DATE
,CASE WHEN С.Пол=2 THEN 'F' ELSE 'M' END as SEX
,'' as ATTRIBUTE_CATEGORY
,'' as ATTRIBUTE1
,'' as ATTRIBUTE2
,'' as ATTRIBUTE3
,'' as ATTRIBUTE4
,'' as ATTRIBUTE5
,'' as ATTRIBUTE6
,'' as ATTRIBUTE7
,'' as ATTRIBUTE8
,'' as ATTRIBUTE9
,'' as ATTRIBUTE10
,'' as ATTRIBUTE11
,'' as ATTRIBUTE12
,'' as ATTRIBUTE13
,'' as ATTRIBUTE14
,'' as ATTRIBUTE15
,'' as ATTRIBUTE16
,'' as ATTRIBUTE17
,'' as ATTRIBUTE18
,'' as ATTRIBUTE19
,'' as ATTRIBUTE20
,'' as ATTRIBUTE21
,'' as ATTRIBUTE22
,'' as ATTRIBUTE23
,'' as ATTRIBUTE24
,'' as ATTRIBUTE25
,'' as ATTRIBUTE26
,'' as ATTRIBUTE27
,'' as ATTRIBUTE28
,'' as ATTRIBUTE29
,'' as ATTRIBUTE30
,'' as PER_INFROMATION_CATEGORY
,'' as PER_INFORMATION1
,'' as PER_INFORMATION2
,'' as PER_INFORMATION3
,'' as PER_INFORMATION4
,'' as PER_INFORMATION5
,'' as PER_INFORMATION6
,'' as PER_INFORMATION7
,'' as PER_INFORMATION8
,'' as PER_INFORMATION9
,'' as PER_INFORMATION10
,'' as PER_INFORMATION11
,'' as PER_INFORMATION12
,'' as PER_INFORMATION13
,'' as PER_INFORMATION14
,'' as PER_INFORMATION15
,'' as PER_INFORMATION16
,'' as PER_INFORMATION17
,'' as PER_INFORMATION18
,'' as PER_INFORMATION19
,'' as PER_INFORMATION20
,'' as PER_INFORMATION21
,'' as PER_INFORMATION22
,'' as PER_INFORMATION23
,'' as PER_INFORMATION24
,'' as PER_INFORMATION25
,'' as PER_INFORMATION26
,'' as PER_INFORMATION27
,'' as PER_INFORMATION28
,'' as PER_INFORMATION29
,'' as PER_INFORMATION30
,'' as PER_INFORMATION_DATE1
,'' as PER_INFORMATION_DATE2
,'' as PER_INFORMATION_DATE3
,'' as PER_INFORMATION_DATE4
,'' as PER_INFORMATION_DATE5
,'' as PER_INFORMATION_DATE6
,'' as PER_INFORMATION_DATE7
,'' as PER_INFORMATION_DATE8
,'' as PER_INFORMATION_DATE9
,'' as PER_INFORMATION_DATE10
,'' as PER_INFORMATION_DATE11
,'' as PER_INFORMATION_DATE12
,'' as PER_INFORMATION_DATE13
,'' as PER_INFORMATION_DATE14
,'' as PER_INFORMATION_DATE15
,'' as PER_INFORMATION_NUMBER1
,'' as PER_INFORMATION_NUMBER2
,'' as PER_INFORMATION_NUMBER3
,'' as PER_INFORMATION_NUMBER4
,'' as PER_INFORMATION_NUMBER5
,'' as PER_INFORMATION_NUMBER6
,'' as PER_INFORMATION_NUMBER7
,'' as PER_INFORMATION_NUMBER8
,'' as PER_INFORMATION_NUMBER9
,'' as PER_INFORMATION_NUMBER10
,'' as PER_INFORMATION_NUMBER11
,'' as PER_INFORMATION_NUMBER12
,'' as PER_INFORMATION_NUMBER13
,'' as PER_INFORMATION_NUMBER14
,'' as PER_INFORMATION_NUMBER15
,'' as PER_INFORMATION_NUMBER16
,'' as PER_INFORMATION_NUMBER17
,'' as PER_INFORMATION_NUMBER18
,'' as PER_INFORMATION_NUMBER19
,'' as PER_INFORMATION_NUMBER20
,'PERS_DATA_EFFDT' as FT_ALTERNATE_REC
,CONCAT('L',CRC32(UPPER(TRIM(С.ФИО)))) as FT_ALTERNATE_KEY
FROM kontrotenko_ktga.`Приказы` П
JOIN kontrotenko_ktga.`Сотрудники` С
ON П.`КодСотрудника`=С.`КодСотрудника`
GROUP BY UPPER(TRIM(С.`ФИО`))
) KTGA
) ALLS_WITH_ORDER
ORDER BY ALLS_WITH_ORDER.EFFECTIVE_START_DATE ASC
) ALLS
GROUP BY ALLS.PERSON_ID