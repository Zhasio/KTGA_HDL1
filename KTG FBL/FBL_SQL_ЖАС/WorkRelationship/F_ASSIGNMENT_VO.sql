SELECT CASE WHEN П.`КодСтатьи1` LIKE '100%' THEN 'HIRE' WHEN П.`КодСтатьи1` LIKE '200%' THEN 'TRANSFER' WHEN П.`КодСтатьи1` LIKE '300%' THEN 'TERMINATION' END AS ACTION_CODE,'' AS ACTION_OCCURRENCE_ID, CONCAT('ASSIG',П.`КодПриказа`) AS ASSIGNMENT_ID, CONCAT('ASSIG',П.`КодПриказа`) AS ASSIGNMENT_NAME,'' AS ASSIGNMENT_NUMBER,'1' AS ASSIGNMENT_SEQUENCE,'ACTIVE' AS ASSIGNMENT_STATUS_TYPE,'119E67C19B66375BE053A747660A4A5B' AS ASSIGNMENT_STATUS_TYPE_ID,'E' AS ASSIGNMENT_TYPE,'Y' AS AUTO_END_FLAG,'' AS BARGAINING_UNIT_CODE,'' AS BILLING_TITLE,'11A3CAC8E20AB4E6E053A747660AF6EC' AS BUSINESS_GROUP_ID,'1595C93AA3F5DCB2E053A747660A09BD' AS BUSINESS_UNIT_ID,'' AS CAGR_GRADE_DEF_ID,'' AS CAGR_ID_FLEX_NUM,'' AS COLLECTIVE_AGREEMENT_ID,'' AS CONTRACT_ID,'' AS DATE_PROBATION_END,'' AS DEFAULT_CODE_COMB_ID,'' AS DUTIES_TYPE,'4712-12-31' AS EFFECTIVE_END_DATE,'' AS EFFECTIVE_LATEST_CHANGE,'1' AS EFFECTIVE_SEQUENCE, DATE_FORMAT(П.`Дата`,'%Y-%m-%d') AS EFFECTIVE_START_DATE,'' AS EMPLOYEE_CATEGORY,'FR' AS EMPLOYMENT_CATEGORY,'' AS ESTABLISHMENT_ID,'' AS EXPENSE_CHECK_ADDRESS,'W' AS FREQUENCY,'' AS GRADE_ID,'' AS GRADE_LADDER_PGM_ID,'S' AS HOURLY_SALARIED_CODE,'' AS INTERNAL_BUILDING,'' AS INTERNAL_FLOOR,'' AS INTERNAL_LOCATION,'' AS INTERNAL_MAILSTOP,'' AS INTERNAL_OFFICE_NUMBER, CONCAT('KTGA_',Ф.`КодДол`) AS JOB_ID,'' AS JOB_POST_SOURCE_NAME,'N' AS LABOUR_UNION_MEMBER_FLAG,'119E67C19A24375BE053A747660A4A5B' AS LEGAL_ENTITY_ID,'KZ' AS LEGISLATION_CODE,'' AS LINKAGE_TYPE,'1595C93AA609DCB2E053A747660A09BD' AS LOCATION_ID,'' AS MANAGER_FLAG,40 AS NORMAL_HOURS,0 AS NOTICE_PERIOD,'' AS NOTICE_PERIOD_UOM, CONCAT('KTGA_',(
SELECT Д.`КодПодразделения`
FROM `Должности` Д
WHERE Д.`КодДолжности`=П.`КодДолжности`)) ORGANIZATION_ID,'' AS PARENT_ASSIGNMENT_ID,'' AS PEOPLE_GROUP_ID, CONCAT('PERIOD', П.`КодПриказа`) AS PERIOD_OF_SERVICE_ID, CONCAT('P', П.`КодСотрудника`) AS PERSON_ID,'119E67C19A2D375BE053A747660A4A5B' AS PERSON_TYPE_ID,'' AS PO_HEADER_ID,'' AS PO_LINE_ID,'' AS POSITION_ID,'Y' AS POSITION_OVERRIDE_FLAG,'' AS POSTING_CONTENT_ID,'Y' AS PRIMARY_ASSIGNMENT_FLAG,'Y' AS PRIMARY_FLAG,'Y' AS PRIMARY_WORK_RELATION_FLAG,'' AS PRIMARY_WORK_TERMS_FLAG,'' AS PROBATION_PERIOD,'' AS PROBATION_UNIT,'' AS PROJECT_TITLE,'' AS PROJECTED_ASSIGNMENT_END,'' AS PROPOSED_WORKER_TYPE,CASE WHEN П.`КодСтатьи1` LIKE '100%' THEN 'NEWHIRE' WHEN П.`КодСтатьи1` LIKE '200%' THEN 'WORKERREQ' WHEN П.`КодСтатьи1` LIKE '300%' THEN 'CMP_PER' END AS REASON_CODE,'' AS RECORD_CREATOR,0 AS RETIREMENT_AGE,'' AS RETIREMENT_DATE,'' AS SAL_REVIEW_PERIOD,'' AS SAL_REVIEW_PERIOD_FREQUENCY,'' AS SET_OF_BOOKS_ID,'' AS SOURCE_TYPE,'' AS SPECIAL_CEILING_STEP_ID,'' AS STEP_ENTRY_DATE,'EMP' AS SYSTEM_PERSON_TYPE,'' AS TAX_ADDRESS_ID,'' AS TIME_NORMAL_FINISH,'' AS TIME_NORMAL_START,'' AS VENDOR_ASSIGNMENT_NUMBER,'' AS VENDOR_EMPLOYEE_NUMBER,'' AS VENDOR_ID,'' AS VENDOR_SITE_ID,'' AS WORK_AT_HOME, CONCAT('WT_ASSIG',П.`КодПриказа`) AS WORK_TERMS_ASSIGNMENT_ID,'1901-01-01' AS FREEZE_START_DATE,'4712-12-31' AS FREEZE_UNTIL_DATE,'WT' AS FT_ALTERNATE_REC, CONCAT('ASSIG', П.`КодПриказа`,'::ASSIGNMENT') AS FT_ALTERNATE_KEY
FROM `Приказы` П
JOIN `Должности` ДЖ ON П.`КодДолжности`=ДЖ.`КодДолжности`
JOIN (
SELECT MAX(Ж.`КодДолжности`) AS `КодДол`, Ж.`Наименование`
FROM `Должности` Ж
GROUP BY Ж.`Наименование`) Ф ON Ф.`Наименование`=ДЖ.`Наименование`
WHERE П.`КодСтатьи1` REGEXP '^100|^200|^300'